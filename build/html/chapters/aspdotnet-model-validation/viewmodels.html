<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>15.1. ViewModels and Passing Data To and From Views &mdash; Textbook Template 2022 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="15.2. Server-Side Validation" href="server-side-validation.html" />
    <link rel="prev" title="15. ViewModels and Model Validation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: purple" >
            <a href="../../index.html" class="icon icon-home"> Textbook Template
            <img src="../../_static/lc-ed-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction-and-setup/index.html">1. Introduction and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-types/index.html">2. Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../control-flow-and-collections/index.html">3. Control Flow and Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classes/index.html">4. Classes in C#, Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classes-part2/index.html">5. Classes and Objects, Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit-testing/index.html">6. Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inheritance/index.html">7. Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interfaces-and-polymorphism/index.html">8. Interfaces and Polymorphism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aspdotnet-intro/index.html">9. Introduction to ASP.NET</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aspdotnet-controllers-and-routes/index.html">10. Controllers and Routing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions/index.html">11. Rules to the Exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vstools/index.html">12. Tools in Visual Studio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../razor-views/index.html">13. Razor Views</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aspdotnet-model-classes/index.html">14. Models and Model Binding</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">15. ViewModels and Model Validation</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">15.1. ViewModels and Passing Data To and From Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#refactoring-the-view-and-controller-to-use-a-model-in-a-view-video">15.1.1. Refactoring the View and Controller to Use a Model in a View - Video</a></li>
<li class="toctree-l3"><a class="reference internal" href="#refactoring-the-view-and-controller-to-use-a-model-in-a-view-text">15.1.2. Refactoring the View and Controller to Use a Model in a View - Text</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-a-viewmodel-video">15.1.3. Adding a ViewModel - Video</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-a-viewmodel-text">15.1.4. Adding a ViewModel - Text</a></li>
<li class="toctree-l3"><a class="reference internal" href="#check-your-understanding">15.1.5. Check Your Understanding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="server-side-validation.html">15.2. Server-Side Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation-attributes.html">15.3. Validation Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation-controller.html">15.4. Validating Models in a Controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation-views.html">15.5. Validation and Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="exercises.html">15.6. Exercises: ViewModels and Model Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="studio.html">15.7. Studio: Spa User Validation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../enums/index.html">16. Enumeration Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orm-intro/index.html">17. Introduction to Object-Relational Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../orm-relationships/index.html">18. Relationships in Object-Relational Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auth/index.html">19. Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web-apis/index.html">20. Introduction to Web APIs &amp; REST</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/sql-install.html">Installing SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/vs-troubleshooting.html">Visual Studio Operational Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/postman-install.html">Installing Postman</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendices/exercise-solutions/index.html">Exercise Solutions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: purple" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Textbook Template</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html"><span class="section-number">15. </span>ViewModels and Model Validation</a> &raquo;</li>
      <li><span class="section-number">15.1. </span>ViewModels and Passing Data To and From Views</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/chapters/aspdotnet-model-validation/viewmodels.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="viewmodels-and-passing-data-to-and-from-views">
<span id="index-0"></span><h1><span class="section-number">15.1. </span>ViewModels and Passing Data To and From Views<a class="headerlink" href="#viewmodels-and-passing-data-to-and-from-views" title="Permalink to this headline"></a></h1>
<p>Now that we have an understanding for what a model is, we can focus on how to effectively pass information between the three elements of MVC applications.
With our current MVC application, we can add new events and remove events.
However, our application is also susceptible to run-time errors.
Our view can accept any type of input and if we mistype something in our view, we can run into issues later down the line.</p>
<p>A <strong>ViewModel</strong> is a model class designed specifically to be used in a view.
By utilizing ViewModels in our application, we can make our views strongly-typed and add validation to forms to prevent bad user input.
Also, if we have information we want to collect as part of a form, but not save as part of a model, we can store that data as a property of a ViewModel.
An example of this would be if we have a form for users to create an account on our site.
The form includes two fields: one for the password and one for confirming the new user’s password.
While we only want to save the password and may only have a <code class="docutils literal notranslate"><span class="pre">Password</span></code> property in our model, we can add a <code class="docutils literal notranslate"><span class="pre">ConfirmPassword</span></code> property to the ViewModel so we can check that the two match before saving the user’s info.
These benefits of ViewModels will help reduce potential errors in our application.</p>
<div class="section" id="refactoring-the-view-and-controller-to-use-a-model-in-a-view-video">
<h2><span class="section-number">15.1.1. </span>Refactoring the View and Controller to Use a Model in a View - Video<a class="headerlink" href="#refactoring-the-view-and-controller-to-use-a-model-in-a-view-video" title="Permalink to this headline"></a></h2>

<div style="text-align:center;"><iframe width="800" height="450" src="https://www.youtube.com/embed/_lUUT1oDE-U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p></p>
<div class="admonition-note admonition">
<p class="admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p>If you want to verify what code this video starts with, check out the <a class="reference external" href="https://github.com/LaunchCodeEducation/CodingEventsDemo/tree/model-binding" target="_blank">model-binding<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> branch.
If you want to verify what code this video ends with, check out the <a class="reference external" href="https://github.com/LaunchCodeEducation/CodingEventsDemo/tree/models-in-views" target="_blank">models-in-views<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> branch.</p>
</div>
</div>
<div class="section" id="refactoring-the-view-and-controller-to-use-a-model-in-a-view-text">
<h2><span class="section-number">15.1.2. </span>Refactoring the View and Controller to Use a Model in a View - Text<a class="headerlink" href="#refactoring-the-view-and-controller-to-use-a-model-in-a-view-text" title="Permalink to this headline"></a></h2>
<p>To start with understanding why we may want to use a ViewModel, let’s refactor our code to use a model directly in our view.</p>
<p>First, in <code class="docutils literal notranslate"><span class="pre">EventsController</span></code>, we want to convert the collection of Events we have been holding into a list.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="linenos">19</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Event</span><span class="p">&gt;</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="p">&lt;</span><span class="n">Event</span><span class="p">&gt;(</span><span class="n">EventData</span><span class="p">.</span><span class="n">GetAll</span><span class="p">());</span><span class="w"></span>
</pre></div>
</div>
<p>Now that we are storing our items in a <code class="docutils literal notranslate"><span class="pre">List</span></code>, we need to import the model into our <code class="docutils literal notranslate"><span class="pre">Events/Index.cshtml</span></code> view so we can use the new <code class="docutils literal notranslate"><span class="pre">events</span></code> collection.
We can add a small statement up on line 1 to do so:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">@model</span><span class="w"> </span><span class="n">List</span><span class="p">&lt;</span><span class="n">CodingEventsDemo</span><span class="p">.</span><span class="n">Models</span><span class="p">.</span><span class="n">Event</span><span class="p">&gt;</span><span class="w"></span>
</pre></div>
</div>
<p>Or, as we write in the video:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">@using</span><span class="w"> </span><span class="n">CodingEventsDemo</span><span class="p">.</span><span class="n">Models</span><span class="w"></span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="n">@model</span><span class="w"> </span><span class="n">List</span><span class="p">&lt;</span><span class="n">Event</span><span class="p">&gt;</span><span class="w"></span>
</pre></div>
</div>
<p>Wherever we used our <code class="docutils literal notranslate"><span class="pre">ViewBag</span></code> property, we can now use <code class="docutils literal notranslate"><span class="pre">Model</span></code> syntax.
Once the view has been updated, run the application!</p>
<p>This was merely a refactor so the functionality of the app hasn’t changed, but we have eliminated some of the possibility of bugs in our code being discovered at runtime!
Using a model in a view like this makes our view <em>strongly-typed</em>.
Before if we misspelled a property of <code class="docutils literal notranslate"><span class="pre">Event</span></code> or <code class="docutils literal notranslate"><span class="pre">ViewBag</span></code>, those errors would have been caught at run-time and possibly interfered with users’ experience.
With a strongly-typed view, the same errors would be caught at compile-time before users see the application.
Strongly-typed views also support intellisense, so as we work with properties of a model, we can make sure we have the correct property name.</p>
</div>
<div class="section" id="adding-a-viewmodel-video">
<h2><span class="section-number">15.1.3. </span>Adding a ViewModel - Video<a class="headerlink" href="#adding-a-viewmodel-video" title="Permalink to this headline"></a></h2>

<div style="text-align:center;"><iframe width="800" height="450" src="https://www.youtube.com/embed/XAPP0VTiwk8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p></p>
<div class="admonition-note admonition">
<p class="admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p>If you want to verify what code this video starts with, check out the <a class="reference external" href="https://github.com/LaunchCodeEducation/CodingEventsDemo/tree/models-in-views" target="_blank">models-in-views<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> branch.
If you want to verify what code this video ends with, check out the <a class="reference external" href="https://github.com/LaunchCodeEducation/CodingEventsDemo/tree/adding-viewmodels" target="_blank">adding-viewmodels<i class="fas fa-external-link-alt" aria-hidden="true"></i></a> branch.</p>
</div>
</div>
<div class="section" id="adding-a-viewmodel-text">
<h2><span class="section-number">15.1.4. </span>Adding a ViewModel - Text<a class="headerlink" href="#adding-a-viewmodel-text" title="Permalink to this headline"></a></h2>
<p>Now that we have refactored our <code class="docutils literal notranslate"><span class="pre">Events/Index.cshtml</span></code> view and <code class="docutils literal notranslate"><span class="pre">EventsController</span></code> to use a model, let’s investigate how to create a ViewModel.
We can do so by following these steps:</p>
<ol class="arabic">
<li><p>Add a <code class="docutils literal notranslate"><span class="pre">ViewModels</span></code> directory at the top level of the project.</p></li>
<li><p>Add a new class to the <code class="docutils literal notranslate"><span class="pre">ViewModels</span></code> directory and name it <code class="docutils literal notranslate"><span class="pre">AddEventViewModel</span></code>.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">Name</span></code> and <code class="docutils literal notranslate"><span class="pre">Description</span></code> properties to the new class.</p>
<div class="admonition-note admonition">
<p class="admonition-title"><i class="fas fa-sticky-note" aria-hidden="true"></i>Note</p>
<p>For now, your ViewModel does not need a constructor!</p>
</div>
</li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Add()</span></code> action method responsible for retrieving the form to add events, in <code class="docutils literal notranslate"><span class="pre">EventsController</span></code>, create a new instance of <code class="docutils literal notranslate"><span class="pre">AddEventViewModel</span></code> called <code class="docutils literal notranslate"><span class="pre">addEventViewModel</span></code> and add it to the <code class="docutils literal notranslate"><span class="pre">View()</span></code>.</p></li>
<li><p>Import the ViewModel to the <code class="docutils literal notranslate"><span class="pre">Add.cshtml</span></code> view with the <code class="docutils literal notranslate"><span class="pre">&#64;model</span></code> syntax.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">asp-controller</span> <span class="pre">=</span> <span class="pre">Events</span></code> and <code class="docutils literal notranslate"><span class="pre">asp-action</span> <span class="pre">=</span> <span class="pre">NewEvent</span></code> to the <code class="docutils literal notranslate"><span class="pre">&lt;form&gt;</span></code> tag to designate which method the form data should be sent to.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">asp-for</span></code> to <code class="docutils literal notranslate"><span class="pre">&lt;label&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;input&gt;</span></code> tags. This allows us to specify which form field corresponds to which property in our ViewModel.</p></li>
<li><p>Refactor the <code class="docutils literal notranslate"><span class="pre">NewEvent()</span></code> action method to be named <code class="docutils literal notranslate"><span class="pre">Add()</span></code>. Have it also now use the ViewModel as its parameter. Set values of a new <code class="docutils literal notranslate"><span class="pre">Event</span></code> object using the values of the properties stored in the instance of the <code class="docutils literal notranslate"><span class="pre">AddEventViewModel</span></code>.</p></li>
<li><p>Add the new <code class="docutils literal notranslate"><span class="pre">Event</span></code> object to <code class="docutils literal notranslate"><span class="pre">EventData</span></code> and make sure that the method still returns a <code class="docutils literal notranslate"><span class="pre">Redirect</span></code> to <code class="docutils literal notranslate"><span class="pre">/Events</span></code>.</p></li>
<li><p>Run your application.</p></li>
</ol>
<p>Following these steps, we effectively refactored our application to use a ViewModel.
While the functionality of the application remains the same, we are now in a position to easily add validation to our application.</p>
</div>
<div class="section" id="check-your-understanding">
<h2><span class="section-number">15.1.5. </span>Check Your Understanding<a class="headerlink" href="#check-your-understanding" title="Permalink to this headline"></a></h2>
<div class="admonition-question admonition">
<p class="admonition-title"><i class="fas fa-question" aria-hidden="true"></i>Question</p>
<p><strong>True or False</strong> ViewModels are views designed to specifically be used in models.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="15. ViewModels and Model Validation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="server-side-validation.html" class="btn btn-neutral float-right" title="15.2. Server-Side Validation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, LaunchCode.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>